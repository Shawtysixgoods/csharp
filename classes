

## 1. Ссылочные и значимые типы данных

### Значимые типы (Value Types)

Значимые типы — это типы данных, которые хранят свое значение непосредственно внутри переменной. Они размещаются в стеке памяти. При присваивании или передаче в методы создаётся копия значения.

#### Примеры значимых типов:

- `int`, `bool`, `double`, `char`
- `struct` (например, пользовательские структуры Point, Color и др.)

```csharp
int number = 42;
double price = 99.99;
struct Point { public int X; public int Y; }
```


#### Особенности:

- Быстрое выделение и освобождение памяти
- Автоматическая очистка при выходе из области видимости
- Не принимают значение `null` (исключение — nullable value types)

***

### Ссылочные типы (Reference Types)

Ссылочные типы вместо основного значения хранят ссылку на объект, который размещён в управляемой куче.

#### Примеры ссылочных типов:

- `string`, `object`, массивы (`int[]`), пользовательские классы

```csharp
string text = "Hello World";
class Person { public string Name { get; set; } }
Person person = new Person();
```


#### Особенности:

- Сам объект хранится в куче, а переменная содержит только ссылку
- При присваивании копируется ссылка
- Могут содержать значение `null`
- Управляются сборщиком мусора

***

### Размещение в памяти: стек и куча

- **Стек (stack)**: хранение значимых типов, быстрые операции, ограниченный размер
- **Куча (heap)**: хранение объектов ссылочных типов, больше пространства, управляется сборщиком мусора

***

### Упаковка и распаковка (Boxing / Unboxing)

- **Упаковка** — процесс превращения значения значимого типа в объект ссылочного типа (`object`).
- **Распаковка** — извлечение значения обратно из объекта.

```csharp
int value = 123;
object boxed = value; // упаковка
int unboxed = (int)boxed; // распаковка
```

Эти операции требуют дополнительных затрат по времени и памяти, поэтому в производительно-важных местах их следует избегать.

***

## 2. Null и Nullable типы

### Null

`null` — специальное значение, обозначающее отсутствие ссылки на объект. Только ссылочные типы и nullable value types могут быть равны `null`.

```csharp
string text = null;      // допустимо
int number = null;       // ошибка
int? number2 = null;     // допустимо
```


***

### Nullable Value Types

C помощью `?` можно разрешить значимому типу принимать значение `null`:

```csharp
int? age = null;
```

Для проверки используется `HasValue` или сравнение с `null`.

***

### Nullable Reference Types (C\# 8.0+)

Позволяют отмечать ссылочные типы как допускающие (`string?`) или не допускающие (`string`) значение `null`. Помогают предотвращать ошибки времени выполнения типа NullReferenceException.

***

## 3. Структуры (struct)

### Определение

Структуры — это пользовательские значимые типы. Подходят для небольших, простых единиц данных.

```csharp
public struct Point3D
{
    public double X, Y, Z;
    public double Length() => Math.Sqrt(X*X + Y*Y + Z*Z);
}
```


***

### Особенности структур:

- Не поддерживают наследование
- Не могут быть базовыми для других типов
- Могут реализовывать интерфейсы
- Значение копируется при передаче в методы или присваивании

Используйте struct для координат, цветов, диапазонов, маленьких immutable-объектов.

***

## 4. Классы vs Структуры

| Характеристика | Класс (class) | Структура (struct) |
| :-- | :-- | :-- |
| Тип данных | Ссылочный | Значимый |
| Размещение | Куча | Стек |
| Копирование | Копируется ссылка | Копируется значение |
| Наследование | Поддерживается | Не поддерживается |
| Принимает null | Да | Только через ? |
| Использование | Сложные объекты | Примитивные, простые данные |


***

## 5. Абстрактные классы (abstract class)

Абстрактный класс — класс, помеченный как `abstract`. Его нельзя инстанцировать; он служит основой для наследующих классов.

```csharp
public abstract class Animal
{
    public string Name { get; set; }
    public abstract void MakeSound();
    public virtual void Sleep() => Console.WriteLine($"{Name} спит");
}
public class Dog : Animal
{
    public override void MakeSound() => Console.WriteLine("Гав");
}
```

- Может содержать как абстрактные, так и обычные методы.
- Может содержать поля, свойства, конструкторы.
- Используется для создания общего функционала для группы родственных классов.

***

## 6. Статические классы (static class)

Статический класс объявляется с помощью ключевого слова `static`. В нем могут быть только статические члены. Создавать экземпляры нельзя.

```csharp
public static class MathHelper
{
    public static double Pi = 3.14159;
    public static double CircleArea(double r) => Pi * r * r;
}
```

- Не может наследовать или быть унаследованным
- Используется для служебных методов, констант, утилитарных функций

***

## 7. Интерфейсы (interface)

Интерфейс — это контракт, который описывает набор методов, свойств, событий и индексов без реализации.

```csharp
public interface IDrawable
{
    void Draw();
    string Color { get; set; }
}
public class Circle : IDrawable
{
    public string Color { get; set; }
    public void Draw() => Console.WriteLine("Рисую круг");
}
```

- Можно реализовывать несколько интерфейсов одновременно.
- Интерфейсы не содержат состояния (полей) и конструкторов.
- В C\# 8.0+ можно реализовывать методы по умолчанию внутри интерфейса.

***

## 8. Абстрактные классы vs Интерфейсы

| Аспект | Абстрактный класс | Интерфейс |
| :-- | :-- | :-- |
| Наследование | Только одно | Множественное |
| Реализация методов | Есть реализованные методы | Только контракт (до C\# 8.0) |
| Наличие полей | Да | Нет |
| Конструкторы | Да | Нет |
| Модификаторы доступа | Любые | Только public |
| Совместимость со структурами | Нет | Да |
| Использование | Базовый функционал | Поведенческий контракт |

**Когда использовать абстрактный класс:** для четко выраженной иерархии классов с общей реализацией методов и/или свойств.

**Когда использовать интерфейс:** для задания функциональных возможностей классу или структуре, при этом не имея общей реализации.

***

## 9. Практические рекомендации

- Используйте `struct` для небольших, неизменяемых, простых объектов.
- Используйте `class` для сложных, изменяемых структур, требующих наследования.
- Используйте `static class` для библиотек утилит и служебных методов.
- Используйте интерфейсы для абстракций поведения и множественной реализации.
- Используйте абстрактные классы для создания частично реализованных базовых классов.


